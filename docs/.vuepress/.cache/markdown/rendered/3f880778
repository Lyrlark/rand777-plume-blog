{"content":"<h2 id=\"_1-组合式api\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-组合式api\"><span>1. 组合式API</span></a></h2>\n<h3 id=\"_1-1-使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-使用\"><span>1.1 使用</span></a></h3>\n<p><strong>执行时期：</strong><code v-pre>setup()</code>在在<code v-pre>beforeCreate</code>钩子之前执行。<br>\n在setup函数中写的数据和方法需要在末尾以对象的方式return，才能给模版使用：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">export</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> default</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(){</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">      const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is message</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">      const</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> logMessage</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ()=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">      // 必须return才可以</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        logMessage</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong><code v-pre>&lt;script setup&gt;</code>语法糖</strong>： script标签添加 setup标记，不需要再写导出语句，默认会添加导出语句。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const message = 'this is message'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const logMessage = ()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-2-reactive和ref函数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-reactive和ref函数\"><span>1.2 reactive和ref函数</span></a></h3>\n<ul>\n<li>reactive<br>\n接受<strong>对象类型</strong>数据的参数传入并返回一个响应式的对象。</li>\n</ul>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 导入</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 执行函数 传入参数 变量接收</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const state = reactive(</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    msg</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is msg</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const setSate = ()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 修改数据更新视图</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    state</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">msg</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is new msg</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>ref<br>\n接收<strong>简单类型或者对象类型</strong>的数据传入并返回一个响应式的对象。实际上<code v-pre>ref</code>在底层仍然是借助<code v-pre>reactive</code>实现，它将简单数据包成复杂类型后返回。</li>\n</ul>\n<div class=\"language-vue line-numbers-mode\" data-ext=\"vue\" data-title=\"vue\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">template</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  {{count}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">template</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-3-reactive-对比-ref\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-3-reactive-对比-ref\"><span>1.3 reactive 对比 ref</span></a></h3>\n<ol>\n<li>都是用来生成响应式数据。</li>\n<li>不同点：</li>\n</ol>\n<ul>\n<li>reactive不能处理简单类型的数据</li>\n<li>ref参数类型支持更好，但是必须通过.value做访问修改</li>\n<li>ref函数内部的实现依赖于reactive函数</li>\n</ul>\n<ol start=\"3\">\n<li>在实际工作中的推荐使用<code v-pre>ref</code>函数。</li>\n</ol>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>js中访问 ref 需要添加 .value 。<br>\n在 template 中，.value 不需要添加。</p>\n</div>\n<h3 id=\"_1-4-computed\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-computed\"><span>1.4 computed</span></a></h3>\n<p>计算属性基本思想和Vue2保持一致，组合式API下的计算属性只是修改了API写法。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// script setup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 原始数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">7</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">8</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 计算属性list 过滤大于2后的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> filterList</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(()=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">filter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>若需要使用<code v-pre>set</code>与<code v-pre>get</code>，只需要将函数写为对象：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// script setup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 原始数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 计算属性list 过滤大于2后的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> countPlusOne</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:()=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=></span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> //修改逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-4-watch\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-watch\"><span>1.4 watch</span></a></h3>\n<p>语法：<code v-pre>watch</code> 传入的是 <code v-pre>ref对象</code> ，因此监听对象不需要写 <code v-pre>.value</code>。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">对象</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> .....</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> })</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-1-侦听单个数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-1-侦听单个数据\"><span>1.4.1 侦听单个数据</span></a></h4>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 1. 导入watch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const count = ref(0)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 2. 调用watch 侦听变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  watch(count, (newValue, oldValue)=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count发生了变化，老值为</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">${</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">oldValue</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">}</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,新值为</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">${</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">newValue</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-2-侦听多个数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-2-侦听多个数据\"><span>1.4.2 侦听多个数据</span></a></h4>\n<p>侦听多个数据，第一个参数可以改写成<strong>数组</strong>的写法：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 1. 导入watch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const count = ref(0)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const name = ref('cp')</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 2. 调用watch 侦听变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  watch([count, name], ([newCount, newName],[oldCount,oldName])=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count或者name变化了，[newCount, newName],[oldCount,oldName])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">  })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">&#x3C;/script></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-3-immediate-与-deep\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-3-immediate-与-deep\"><span>1.4.3 immediate 与 deep</span></a></h4>\n<p><strong>immediate</strong>:在侦听器创建时立即出发回调，响应式数据变化之后继续执行回调。<br>\n<strong>deep</strong>:对复杂类型执行深度监听。（Vue <code v-pre>watch</code>默认为浅层监听，<code v-pre>deep:false</code> 无法监听复杂类型数据的变化。）</p>\n<p>语法：<code v-pre>watch( 监听对象, 回调 , immediate 与 deep)</code></p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zhy</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 监听逻辑,,,,,,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">    immediate</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">    deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>当开启 deep:true ,oldValue 总是与 newValue 相同。<br>\nreactive 总是深度响应的,用 reactive 创建的响应式对象，即时 deep:false 也能够监听对象里的所有属性。</p>\n</div>\n<h4 id=\"_1-4-4-精确侦听\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-4-精确侦听\"><span>1.4.4 精确侦听</span></a></h4>\n<p>若不开启deep，只想侦听复杂对象的<strong>某个属性</strong>，则需将 <code v-pre>watch</code> 第一个监听对象参数改为<strong>回调</strong>：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zhy</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// age变化才触发侦听</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(()=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 监听逻辑,,,,,,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-5-生命周期函数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-5-生命周期函数\"><span>1.5 生命周期函数</span></a></h3>\n<p><img src=\"/assets/patch_vue3_lifecycle_01.jpg\" alt=\"patch_vue3_lifecycle_01.jpg\">\n生命周期函数执行多次的时候，会按照顺序依次执行：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">scirpt</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> onMounted</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">onMounted(()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  // 自定义逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">onMounted(()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  // 自定义逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>","env":{"base":"/","filePath":"G:/200-Project/hoey-blog-plume/docs/notes/patch/Vue/vue3.md","filePathRelative":"notes/patch/Vue/vue3.md","frontmatter":{"title":"Vue3新特性","createTime":"2024/11/6 10:19:27","permalink":"/patch/Vue3/"},"sfcBlocks":{"template":{"type":"template","content":"<template><h2 id=\"_1-组合式api\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-组合式api\"><span>1. 组合式API</span></a></h2>\n<h3 id=\"_1-1-使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-使用\"><span>1.1 使用</span></a></h3>\n<p><strong>执行时期：</strong><code v-pre>setup()</code>在在<code v-pre>beforeCreate</code>钩子之前执行。<br>\n在setup函数中写的数据和方法需要在末尾以对象的方式return，才能给模版使用：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">export</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> default</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(){</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">      const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is message</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">      const</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> logMessage</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ()=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">      // 必须return才可以</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        logMessage</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong><code v-pre>&lt;script setup&gt;</code>语法糖</strong>： script标签添加 setup标记，不需要再写导出语句，默认会添加导出语句。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const message = 'this is message'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const logMessage = ()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-2-reactive和ref函数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-reactive和ref函数\"><span>1.2 reactive和ref函数</span></a></h3>\n<ul>\n<li>reactive<br>\n接受<strong>对象类型</strong>数据的参数传入并返回一个响应式的对象。</li>\n</ul>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 导入</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 执行函数 传入参数 变量接收</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const state = reactive(</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    msg</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is msg</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const setSate = ()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 修改数据更新视图</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    state</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">msg</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is new msg</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>ref<br>\n接收<strong>简单类型或者对象类型</strong>的数据传入并返回一个响应式的对象。实际上<code v-pre>ref</code>在底层仍然是借助<code v-pre>reactive</code>实现，它将简单数据包成复杂类型后返回。</li>\n</ul>\n<div class=\"language-vue line-numbers-mode\" data-ext=\"vue\" data-title=\"vue\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">template</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  {{count}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">template</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-3-reactive-对比-ref\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-3-reactive-对比-ref\"><span>1.3 reactive 对比 ref</span></a></h3>\n<ol>\n<li>都是用来生成响应式数据。</li>\n<li>不同点：</li>\n</ol>\n<ul>\n<li>reactive不能处理简单类型的数据</li>\n<li>ref参数类型支持更好，但是必须通过.value做访问修改</li>\n<li>ref函数内部的实现依赖于reactive函数</li>\n</ul>\n<ol start=\"3\">\n<li>在实际工作中的推荐使用<code v-pre>ref</code>函数。</li>\n</ol>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>js中访问 ref 需要添加 .value 。<br>\n在 template 中，.value 不需要添加。</p>\n</div>\n<h3 id=\"_1-4-computed\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-computed\"><span>1.4 computed</span></a></h3>\n<p>计算属性基本思想和Vue2保持一致，组合式API下的计算属性只是修改了API写法。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// script setup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 原始数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">7</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">8</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 计算属性list 过滤大于2后的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> filterList</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(()=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">filter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>若需要使用<code v-pre>set</code>与<code v-pre>get</code>，只需要将函数写为对象：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// script setup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 原始数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 计算属性list 过滤大于2后的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> countPlusOne</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:()=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=></span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> //修改逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-4-watch\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-watch\"><span>1.4 watch</span></a></h3>\n<p>语法：<code v-pre>watch</code> 传入的是 <code v-pre>ref对象</code> ，因此监听对象不需要写 <code v-pre>.value</code>。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">对象</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> .....</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> })</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-1-侦听单个数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-1-侦听单个数据\"><span>1.4.1 侦听单个数据</span></a></h4>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 1. 导入watch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const count = ref(0)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 2. 调用watch 侦听变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  watch(count, (newValue, oldValue)=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count发生了变化，老值为</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">${</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">oldValue</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">}</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,新值为</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">${</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">newValue</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-2-侦听多个数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-2-侦听多个数据\"><span>1.4.2 侦听多个数据</span></a></h4>\n<p>侦听多个数据，第一个参数可以改写成<strong>数组</strong>的写法：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 1. 导入watch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const count = ref(0)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const name = ref('cp')</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 2. 调用watch 侦听变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  watch([count, name], ([newCount, newName],[oldCount,oldName])=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count或者name变化了，[newCount, newName],[oldCount,oldName])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">  })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">&#x3C;/script></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-3-immediate-与-deep\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-3-immediate-与-deep\"><span>1.4.3 immediate 与 deep</span></a></h4>\n<p><strong>immediate</strong>:在侦听器创建时立即出发回调，响应式数据变化之后继续执行回调。<br>\n<strong>deep</strong>:对复杂类型执行深度监听。（Vue <code v-pre>watch</code>默认为浅层监听，<code v-pre>deep:false</code> 无法监听复杂类型数据的变化。）</p>\n<p>语法：<code v-pre>watch( 监听对象, 回调 , immediate 与 deep)</code></p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zhy</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 监听逻辑,,,,,,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">    immediate</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">    deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>当开启 deep:true ,oldValue 总是与 newValue 相同。<br>\nreactive 总是深度响应的,用 reactive 创建的响应式对象，即时 deep:false 也能够监听对象里的所有属性。</p>\n</div>\n<h4 id=\"_1-4-4-精确侦听\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-4-精确侦听\"><span>1.4.4 精确侦听</span></a></h4>\n<p>若不开启deep，只想侦听复杂对象的<strong>某个属性</strong>，则需将 <code v-pre>watch</code> 第一个监听对象参数改为<strong>回调</strong>：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zhy</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// age变化才触发侦听</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(()=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 监听逻辑,,,,,,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-5-生命周期函数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-5-生命周期函数\"><span>1.5 生命周期函数</span></a></h3>\n<p><img src=\"/assets/patch_vue3_lifecycle_01.jpg\" alt=\"patch_vue3_lifecycle_01.jpg\">\n生命周期函数执行多次的时候，会按照顺序依次执行：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">scirpt</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> onMounted</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">onMounted(()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  // 自定义逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">onMounted(()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  // 自定义逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></template>","contentStripped":"<h2 id=\"_1-组合式api\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-组合式api\"><span>1. 组合式API</span></a></h2>\n<h3 id=\"_1-1-使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-使用\"><span>1.1 使用</span></a></h3>\n<p><strong>执行时期：</strong><code v-pre>setup()</code>在在<code v-pre>beforeCreate</code>钩子之前执行。<br>\n在setup函数中写的数据和方法需要在末尾以对象的方式return，才能给模版使用：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">export</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> default</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(){</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">      const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is message</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">      const</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> logMessage</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ()=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">      // 必须return才可以</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">      return</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">        logMessage</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">      }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p><strong><code v-pre>&lt;script setup&gt;</code>语法糖</strong>： script标签添加 setup标记，不需要再写导出语句，默认会添加导出语句。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const message = 'this is message'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const logMessage = ()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">message</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-2-reactive和ref函数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-reactive和ref函数\"><span>1.2 reactive和ref函数</span></a></h3>\n<ul>\n<li>reactive<br>\n接受<strong>对象类型</strong>数据的参数传入并返回一个响应式的对象。</li>\n</ul>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 导入</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> reactive</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 执行函数 传入参数 变量接收</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const state = reactive(</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    msg</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is msg</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const setSate = ()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 修改数据更新视图</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    state</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">msg</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">this is new msg</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><ul>\n<li>ref<br>\n接收<strong>简单类型或者对象类型</strong>的数据传入并返回一个响应式的对象。实际上<code v-pre>ref</code>在底层仍然是借助<code v-pre>reactive</code>实现，它将简单数据包成复杂类型后返回。</li>\n</ul>\n<div class=\"language-vue line-numbers-mode\" data-ext=\"vue\" data-title=\"vue\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">  import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">  const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">template</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  {{count}}</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">template</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-3-reactive-对比-ref\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-3-reactive-对比-ref\"><span>1.3 reactive 对比 ref</span></a></h3>\n<ol>\n<li>都是用来生成响应式数据。</li>\n<li>不同点：</li>\n</ol>\n<ul>\n<li>reactive不能处理简单类型的数据</li>\n<li>ref参数类型支持更好，但是必须通过.value做访问修改</li>\n<li>ref函数内部的实现依赖于reactive函数</li>\n</ul>\n<ol start=\"3\">\n<li>在实际工作中的推荐使用<code v-pre>ref</code>函数。</li>\n</ol>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>js中访问 ref 需要添加 .value 。<br>\n在 template 中，.value 不需要添加。</p>\n</div>\n<h3 id=\"_1-4-computed\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-computed\"><span>1.4 computed</span></a></h3>\n<p>计算属性基本思想和Vue2保持一致，组合式API下的计算属性只是修改了API写法。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// script setup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 原始数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">([</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">7</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">8</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 计算属性list 过滤大于2后的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> filterList</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(()=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    list</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">filter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>若需要使用<code v-pre>set</code>与<code v-pre>get</code>，只需要将函数写为对象：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// script setup</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 原始数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// 计算属性list 过滤大于2后的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> countPlusOne</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> computed</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    get</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:()=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">count</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">    set</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">val</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=></span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> //修改逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-4-watch\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-watch\"><span>1.4 watch</span></a></h3>\n<p>语法：<code v-pre>watch</code> 传入的是 <code v-pre>ref对象</code> ，因此监听对象不需要写 <code v-pre>.value</code>。</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">ref</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">对象</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> .....</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> })</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-1-侦听单个数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-1-侦听单个数据\"><span>1.4.1 侦听单个数据</span></a></h4>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 1. 导入watch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const count = ref(0)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 2. 调用watch 侦听变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  watch(count, (newValue, oldValue)=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count发生了变化，老值为</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">${</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">oldValue</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">}</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">,新值为</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">${</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">newValue</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">}</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">  }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-2-侦听多个数据\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-2-侦听多个数据\"><span>1.4.2 侦听多个数据</span></a></h4>\n<p>侦听多个数据，第一个参数可以改写成<strong>数组</strong>的写法：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 1. 导入watch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const count = ref(0)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  const name = ref('cp')</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  // 2. 调用watch 侦听变化</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">  watch([count, name], ([newCount, newName],[oldCount,oldName])=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">    console</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">log</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">`</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">count或者name变化了，[newCount, newName],[oldCount,oldName])</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">  })</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">&#x3C;/script></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-4-3-immediate-与-deep\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-3-immediate-与-deep\"><span>1.4.3 immediate 与 deep</span></a></h4>\n<p><strong>immediate</strong>:在侦听器创建时立即出发回调，响应式数据变化之后继续执行回调。<br>\n<strong>deep</strong>:对复杂类型执行深度监听。（Vue <code v-pre>watch</code>默认为浅层监听，<code v-pre>deep:false</code> 无法监听复杂类型数据的变化。）</p>\n<p>语法：<code v-pre>watch( 监听对象, 回调 , immediate 与 deep)</code></p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zhy</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 监听逻辑,,,,,,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">},{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">    immediate</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">    deep</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>当开启 deep:true ,oldValue 总是与 newValue 相同。<br>\nreactive 总是深度响应的,用 reactive 创建的响应式对象，即时 deep:false 也能够监听对象里的所有属性。</p>\n</div>\n<h4 id=\"_1-4-4-精确侦听\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-4-4-精确侦听\"><span>1.4.4 精确侦听</span></a></h4>\n<p>若不开启deep，只想侦听复杂对象的<strong>某个属性</strong>，则需将 <code v-pre>watch</code> 第一个监听对象参数改为<strong>回调</strong>：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> {</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">vue</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> =</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ref</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">({</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">zhy</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">18</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">// age变化才触发侦听</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">watch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(()=></span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">refValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">value</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">age</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> ,</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> (</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">newValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">,</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> oldValue</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)=>{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">    // 监听逻辑,,,,,,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">})</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-5-生命周期函数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-5-生命周期函数\"><span>1.5 生命周期函数</span></a></h3>\n<p><img src=\"/assets/patch_vue3_lifecycle_01.jpg\" alt=\"patch_vue3_lifecycle_01.jpg\">\n生命周期函数执行多次的时候，会按照顺序依次执行：</p>\n<div class=\"language-js line-numbers-mode\" data-ext=\"js\" data-title=\"js\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">scirpt</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> setup</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">import </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> onMounted</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> }</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> from 'vue'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">onMounted(()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  // 自定义逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">onMounted(()=></span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">{</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">  // 自定义逻辑</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">script</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"## 1. 组合式API\r\n### 1.1 使用\r\n**执行时期：**`setup()`在在`beforeCreate`钩子之前执行。  \r\n在setup函数中写的数据和方法需要在末尾以对象的方式return，才能给模版使用：\r\n```js\r\nexport default {\r\n    setup(){\r\n      const message = 'this is message'\r\n      const logMessage = ()=>{\r\n        console.log(message)\r\n      }\r\n      // 必须return才可以\r\n      return {\r\n        message,\r\n        logMessage\r\n      }\r\n    }\r\n  }\r\n```\r\n**`<script setup>`语法糖**： script标签添加 setup标记，不需要再写导出语句，默认会添加导出语句。\r\n```js\r\n<script setup>\r\n  const message = 'this is message'\r\n  const logMessage = ()=>{\r\n    console.log(message)\r\n  }\r\n</script>\r\n```\r\n### 1.2 reactive和ref函数\r\n- reactive  \r\n接受**对象类型**数据的参数传入并返回一个响应式的对象。\r\n```js\r\n<script>\r\n  // 导入\r\n  import { reactive } from 'vue'\r\n  // 执行函数 传入参数 变量接收\r\n  const state = reactive({\r\n    msg:'this is msg'\r\n  })\r\n  const setSate = ()=>{\r\n    // 修改数据更新视图\r\n    state.msg = 'this is new msg'\r\n  }\r\n</script>\r\n``` \r\n- ref  \r\n接收**简单类型或者对象类型**的数据传入并返回一个响应式的对象。实际上`ref`在底层仍然是借助`reactive`实现，它将简单数据包成复杂类型后返回。  \r\n\r\n```vue\r\n<script setup>\r\n  import {ref } from 'vue'\r\n  const count = ref(0)\r\n</script>\r\n<template>\r\n  {{count}}\r\n</template>\r\n```\r\n\r\n### 1.3 reactive 对比 ref\r\n1. 都是用来生成响应式数据。\r\n2. 不同点：\r\n- reactive不能处理简单类型的数据\r\n- ref参数类型支持更好，但是必须通过.value做访问修改\r\n- ref函数内部的实现依赖于reactive函数\r\n3. 在实际工作中的推荐使用`ref`函数。\r\n\r\n::: tip\r\njs中访问 ref 需要添加 .value 。  \r\n在 template 中，.value 不需要添加。\r\n:::\r\n\r\n### 1.4 computed\r\n计算属性基本思想和Vue2保持一致，组合式API下的计算属性只是修改了API写法。\r\n```js\r\n// script setup\r\nimport {ref, computed } from 'vue'\r\n// 原始数据\r\nconst list = ref([1,2,3,4,5,6,7,8])\r\n// 计算属性list 过滤大于2后的数据\r\nconst filterList = computed(()=>{\r\n    list.value.filter(item=>item>2)\r\n})\r\n```\r\n若需要使用`set`与`get`，只需要将函数写为对象：\r\n```js\r\n// script setup\r\nimport {ref, computed } from 'vue'\r\n// 原始数据\r\nconst count = ref(1)\r\n// 计算属性list 过滤大于2后的数据\r\nconst countPlusOne = computed({\r\n    get:()=>count.value+1,\r\n    set:(val)=> //修改逻辑\r\n})\r\n```\r\n\r\n### 1.4 watch\r\n语法：`watch` 传入的是 `ref对象` ，因此监听对象不需要写 `.value`。  \r\n```js\r\nwatch(ref对象,(newValue,oldValue)=>{ ..... })\r\n```\r\n#### 1.4.1 侦听单个数据\r\n```js\r\n<script setup>\r\n  // 1. 导入watch\r\n  import { ref, watch } from 'vue'\r\n  const count = ref(0)\r\n  // 2. 调用watch 侦听变化\r\n  watch(count, (newValue, oldValue)=>{\r\n    console.log(`count发生了变化，老值为${oldValue},新值为${newValue}`)\r\n  })\r\n</script>\r\n```\r\n#### 1.4.2 侦听多个数据\r\n侦听多个数据，第一个参数可以改写成**数组**的写法：\r\n```js\r\n<script setup>\r\n  // 1. 导入watch\r\n  import { ref, watch } from 'vue'\r\n  const count = ref(0)\r\n  const name = ref('cp')\r\n  // 2. 调用watch 侦听变化\r\n  watch([count, name], ([newCount, newName],[oldCount,oldName])=>{\r\n    console.log(`count或者name变化了，[newCount, newName],[oldCount,oldName])\r\n  })\r\n</script>\r\n```\r\n\r\n#### 1.4.3 immediate 与 deep\r\n**immediate**:在侦听器创建时立即出发回调，响应式数据变化之后继续执行回调。  \r\n**deep**:对复杂类型执行深度监听。（Vue `watch`默认为浅层监听，`deep:false` 无法监听复杂类型数据的变化。）  \r\n\r\n语法：`watch( 监听对象, 回调 , immediate 与 deep)`  \r\n```js\r\nimport { ref, watch } from 'vue'\r\nconst refValue = ref({name:'zhy',age:18})\r\nwatch(refValue, (newValue, oldValue)=>{\r\n    // 监听逻辑,,,,,,\r\n},{\r\n    immediate: true,\r\n    deep:true\r\n})\r\n```\r\n::: tip\r\n当开启 deep:true ,oldValue 总是与 newValue 相同。  \r\nreactive 总是深度响应的,用 reactive 创建的响应式对象，即时 deep:false 也能够监听对象里的所有属性。\r\n:::\r\n\r\n#### 1.4.4 精确侦听\r\n若不开启deep，只想侦听复杂对象的**某个属性**，则需将 `watch` 第一个监听对象参数改为**回调**：\r\n```js\r\nimport { ref, watch } from 'vue'\r\nconst refValue = ref({name:'zhy',age:18})\r\n// age变化才触发侦听\r\nwatch(()=>refValue.value.age , (newValue, oldValue)=>{\r\n    // 监听逻辑,,,,,,\r\n})\r\n```\r\n\r\n### 1.5 生命周期函数\r\n![patch_vue3_lifecycle_01.jpg](/assets/patch_vue3_lifecycle_01.jpg)\r\n生命周期函数执行多次的时候，会按照顺序依次执行：  \r\n```js\r\n<scirpt setup>\r\nimport { onMounted } from 'vue'\r\nonMounted(()=>{\r\n  // 自定义逻辑\r\n})\r\nonMounted(()=>{\r\n  // 自定义逻辑\r\n})\r\n</script>\r\n```","excerpt":"","tasklists":0,"title":"","headers":[{"level":2,"title":"1. 组合式API","slug":"_1-组合式api","link":"#_1-组合式api","children":[{"level":3,"title":"1.1 使用","slug":"_1-1-使用","link":"#_1-1-使用","children":[]},{"level":3,"title":"1.2 reactive和ref函数","slug":"_1-2-reactive和ref函数","link":"#_1-2-reactive和ref函数","children":[]},{"level":3,"title":"1.3 reactive 对比 ref","slug":"_1-3-reactive-对比-ref","link":"#_1-3-reactive-对比-ref","children":[]},{"level":3,"title":"1.4 computed","slug":"_1-4-computed","link":"#_1-4-computed","children":[]},{"level":3,"title":"1.4 watch","slug":"_1-4-watch","link":"#_1-4-watch","children":[]},{"level":3,"title":"1.5 生命周期函数","slug":"_1-5-生命周期函数","link":"#_1-5-生命周期函数","children":[]}]}]}}
